import "./mid.js"
// src/iinl/html.js
var require_html = __commonJS({
  "src/iinl/html.js"(exports) {
exports.html2 = (x) => `
<!DOCTYPE HTML>
<html xml:lang="uk" lang="uk" dir="ltr" class="device-nonmobile no-js" prefix="og: http://ogp.me/ns#">
   <head>
      <meta charset="utf-8">
      <meta name="apple-mobile-web-app-status-bar-style" content="black">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="google" content="notranslate" />
      <meta name="description" content="Картинка Darnytsia-Amnesia1s розміщена в ImgBB">
      <meta name="robots" content="noindex, nofollow" />
      <title>Darnytsia-Amnesia1s - ImgBB</title>
      <link rel="stylesheet" href="//simgbb.com/3515/ibb.css">
      <link rel="shortcut icon" href="//simgbb.com/images/favicon.png">
      <link rel="icon" type="image/png" href="//simgbb.com/images/favicon.png" sizes="192x192">
      <link rel="apple-touch-icon" href="//simgbb.com/images/favicon.png" sizes="180x180">
      <meta property="og:type" content="article" />
      <meta property="og:url" content="https://ibb.co/pJZrrWh" />
      <meta property="og:title" content="Darnytsia-Amnesia1s" />
      <meta property="og:site_name" content="ImgBB" />
      <meta property="og:description" content="Картинка Darnytsia-Amnesia1s розміщена в ImgBB" />
      <meta property="og:image" content="https://i.ibb.co/Qrnjj8D/Darnytsia-Amnesia1s.jpg" />
      <meta property="og:image:width" content="1280" />
      <meta property="og:image:height" content="1280" />
      <meta name="twitter:card" content="photo">
      <meta name="twitter:description" content="Картинка Darnytsia-Amnesia1s розміщена в ImgBB">
      <meta name="twitter:title" content="Darnytsia-Amnesia1s">
      <meta name="twitter:site" content="@imgbb_com">
      <link rel="alternate" type="application/json+oembed" href="https://ibb.co/pJZrrWh/oembed.json" title="Darnytsia-Amnesia1s - ImgBB">
      <link rel="alternate" type="application/xml+oembed" href="https://ibb.co/pJZrrWh/oembed.xml" title="Darnytsia-Amnesia1s - ImgBB">
      <link rel="image_src" href="https://i.ibb.co/Qrnjj8D/Darnytsia-Amnesia1s.jpg">
   </head>
   <body id="image" class=" no-margin-top">
      <header id="top-bar" class="top-bar white">
         <div class="content-width">
            <div id="logo" class="top-bar-logo"><a href="https://imgbb.com"><img class="replace-svg" src="//simgbb.com/images/logo.png" alt="ImgBB"></a></div>
         </div>
      </header>
      <div class="top-bar-placeholder"></div>
      <div id="image-viewer" class="image-viewer full-viewer margin-bottom-10">
         <div id="image-viewer-container" class="image-viewer-main image-viewer-container"><img src="https://i.ibb.co/syQJJ5W/Darnytsia-Amnesia1s.jpg" alt="Darnytsia-Amnesia1s" width="1280" height="1280" data-load="full"></div>
      </div>
      <div class="content-width">
         <h1 class="viewer-title" data-text="image-title">Darnytsia-Amnesia1s</h1>
         <div id="tabbed-content-group">
            <div id="tab-about" class="tabbed-content visible">
               <div class="c9 phablet-c1 fluid-column grid-columns">
                  <div class="panel-description default-margin-bottom">
                     <p class="description-text margin-bottom-5" data-text="image-description"></p>
                     <p class="description-meta margin-bottom-5">
                        Завантажено <span title="2022-01-17 08:55:24">6 секунд тому</span>
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </body>
</html>
`
    exports.html = (x) => `
    <html prefix="og: https://ogp.me/ns#">
    <head>
      <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
      <meta property="og:type" content="article">
      <meta property="og:title" content="Водохреща 2022">
      <meta property="og:description" content="народні купання в ополонці та баня">
      <meta property="og:image" content="https://i.ibb.co/R2v6mLM/banya-bochka-7.jpg">
      <meta property="og:site_name" content="БАНЯ є БАНЯ">
      <meta property="article:published_time" content="2018-01-25T07:36:53+0000">
     
      <meta property="telegram:channel" content="@banie">
      <meta property="al:ios:app_name" content="Medium">
        </head>
      <body>
    <article class="image-grid">
        <a href="https://ibb.co/fSPLkH4"><img src="https://i.ibb.co/BPSFyBq/i.jpg" alt="i" border="0"></a>
        <a href="https://ibb.co/31KDFc2"><img src="https://i.ibb.co/BLkX6Bb/i.jpg" alt="i" border="0"></a>
        <a href="https://bulma.io/documentation/columns/basics/">Media</a><b>декоративная косметика или другие хрупкие товары нуждаются в дополнителной упаковке при отправление. Доставка таких товаров осуществляется только самолетом. Ориентировочная цена доставки от 25-40 грн за 100 грамм</b><a href="https://bulma.io/documentation/columns/basics/">wrrrr</a>
    <related>
    
 <h3 class="tl_main_recent_news_header">
   <a href="https://telegram.org/blog">Інші новини</a>
</h3>
<a class="dev_blog_card_link_wrap" href="https://telegram.org/blog/video-stickers-better-reactions/uk">
   
      <img class="dev_blog_card_image" src="https://telegram.org/file/464001234/e805/Z0pNrCJET-E.104373/a38ce74977bc53b064">
     
         <h4 class="dev_blog_card_title">Відеоналіпки, удосконалені реакції та інші нововведення</h4>
 
  
</a>
<a class="dev_blog_card_link_wrap" href="https://telegram.org/blog/reactions-spoilers-translations/uk">
   
      <img class="dev_blog_card_image" src="https://telegram.org/file/464001488/d35b/oNi_rR0In0o.124097/c74f7d759893b78bfb"<h4 class="dev_blog_card_title">Захист повідомлень, видалення за датою, керування пристроями та інші нововведення</h4>
         <h4 class="dev_blog_card_title">Захист повідомлень, видалення за датою, керування пристроями та інші нововведення</h4>
         
</a>
<a class="dev_blog_card_link_wrap" href="https://telegram.org/blog/protected-content-delete-by-date-and-more/uk">
   
      <img class="dev_blog_card_image" src="https://telegram.org/file/464001572/2/u_lvhH-CjJ0.99595/a7fca60f9c9e6e193c">
     
         <h4 class="dev_blog_card_title">З22ахист повідомлень, видалення за датою, керування пристроями та інші нововведення</h4>
        
   
</a>
<a class="dev_blog_card_link_wrap" href="https://telegram.org/blog/shared-media-scrolling-calendar-join-requests-and-more/uk">
  
      <img class="dev_blog_card_image" src="https://telegram.org/file/464001930/3/yPTwxfusWZg.174275/3f847742c263cdae99">
      
         <h4 class="dev_blog_card_title">Календар та швидке прокручування в поширених медіа, заявки на вступ, глобальні колірні теми та інші нововведення</h4>
   
</a>
</related>
    </article>


</body>
  </html>
`;
  }
});

// src/iinl/bot.js<related>

var ki = JSON.stringify({
  "inline_keyboard": [
    [{
      "text": "L",
      "callback_data": "LLLL"
    }, {
      "text": ":RE",
      "callback_data": "re"
    }]
  ]
});
var kk = JSON.stringify({
  "inline_keyboard": [
    [{
      "text": "L",
      "callback_data": "LLLL"
    }, {
      "text": ":RE",
      "switch_inline_query_current_chat": ""
    }, {
      "text": "-",
      "callback_data": "-"
    }, {
      "text": "D",
      "switch_inline_query_current_chat": "D"
    }]
  ]
});
var kg = JSON.stringify({ "resize_keyboard": true, "keyboard": [
  [{
    "request_location": true,
    "text": "GEO"
  }, "#M", "$LLL", "@IEEII", "X.co"]
] });
async function bot(update) {
  var bot2 = new Bot(TOKEN, update);
  var bus = new CommandBus();
  bus.on(/\/add/, function() {

  	
    B.reply_markup = JSON.stringify({ "remove_keyboard": true });
    this.replyToSender("1.vvwv.workers.dev/");
  });
  bus.on(/\/help/, function() {
 
    B.reply_markup = JSON.stringify({
      "inline_keyboard": [
        [{
          "text": "LINK",
          "url": `https://t.me/de_nobot?start=${req.chat}`
        }]
      ]
    });
    this.replyToSender(JSON.stringify(v, null, 4));
  });
  bus.on(/^(?=.*LLLL).*$/, reply);
  bus.on(/\/_\s*([A-Za-z0-9_]+)?_\s*([A-Za-z0-9_]+)?/, randomJoke);
  bus.on(/\/start \s*([A-Za-z0-9_]+)?/, deep);
  bus.on(/#\s*([A-я0-9_]+)?/, rH);
  bus.on(/\/_\s*([A-Za-z0-9_]+)?/, randomJ);
  bot2.register(bus);
  if (update) {
    bot2.process();
  }
}
async function rH(x) {
	//console.info(x)
	

  
  B.reply_markup = kk
  this.replyToSender(x);
}
async function deep(x) {
  
  B.reply_markup = kg;
  this.replyToSender(x);
}
async function reply() {
  B.reply_markup = JSON.stringify({ "force_reply": true })
  this.replyToSender(req.data);
}
   async function randomJ(x) {
  B.text = x;
  B.reply_markup = kg;
  this.replyToSender(x);
}
async function randomJoke(name, surname) {
  var firstName = name || null;
  var lastName = surname || null;
  var url = "https://api.icndb.com/jokes/random?escape=javascript";
  if (firstName)
    url = url + "&firstName=" + firstName;
  if (lastName)
    url = url + "&lastName=" + lastName;
  return await fetch(url).then(async (r) => {
    r = await r.json();
    r = r.value.joke;
    B.reply_markup = kk;
    return await this.replyToSender(r);
  });
}
function Bot(token, update) {
  this.token = token;
  this.update = update;
  this.handlers = [];
}
Bot.prototype.register = function(handler) {
  this.handlers.push(handler);
};
Bot.prototype.process = function() {
  for (var i in this.handlers) {
    var event = this.handlers[i];
    return event.handle(this);
  }
};
Bot.prototype.request = async function(method, data) {
};
Bot.prototype.replyToSender = function(text) {
  B.text = text;
  if (B.text)
    B.method = "sendMessage";
};
function CommandBus() {
  this.commands = [];
}
CommandBus.prototype.on = function(regexp, callback) {
  this.commands.push({
    "regexp": regexp,
    "callback": callback
  });
};
CommandBus.prototype.handle = function(bot2) {
  for (var i in this.commands) {
    var cmd = this.commands[i];
    var x = JSON.stringify(bot2.update);
    var tokens = cmd.regexp.exec(x);
    if (tokens != null) {
      return cmd.callback.apply(bot2, tokens.splice(1));
    }
  }
  return bot2.replyToSender(tokens);
}

// src/iinl/66o.js
var import_upd = __toESM(require_upd());
var J = ["shs4a", "wo_va", "shas4a", "rul0n", "cokemonn", "iirij"]
require_console();
var db = require_db();
globalThis.Z = async function(r) {
  try {
    await (0, import_upd.upd)(r);
  } catch (err) {
    console.warn(err);
  }
  // if (J.indexOf(req.from) < 0)
  //   return new Response(console.warn(req), { status: 200 });
  globalThis.v = await db.get(req.from);
  B.chat_id = req.chat;

        if (req.data) {
            
            
           if (req.data == "-") {
await fetch(`https://api.telegram.org/bot${TOKEN}/answerCallbackQuery?callback_query_id=${req.id}&text=❌`);

            req.message_id = req.message.message_id
      }  }

  if (req.ref) {
    await db.add({ ref: req.ref }, req.from);
  }
    if (req.photo) {
  	var t = ''
  	 if (!v.ref) t += " noRef! "
  	 	if (!v.ll) t += " noLL! "
    B.text = t
    B.method = "sendmessage";
  }
  if (req.photo && v.ref && v.ll) {
  	
    var t = ("%20" + v.ll + "%20" + v.ref + "%20" +  req.caption + "%20").toUpperCase().replace(/ /g, "%20").replace(/,/g, "%20");
    req.width = req.width > 960 ? req.width : 960
    var nn = `l_text:roboto%20mono_96_center_bold:V,x_0.17,y_-100/`
   // nn = ''
req.photo = `https://res.cloudinary.com/o6/image/fetch/w_960/g_north,l_${v.pic},y_-480/b_rgb:f5e6e4,c_fill,co_black,g_north,l_text:roboto%20mono_96_center_bold:${t},w_960/${nn}${req.photo}`
//h
    //req.photo = `https://res.cloudinary.com/o6/image/fetch/w_${req.width}/fl_relative,g_north_west,h_300,l_${v.pic},w_300/b_rgb:f5e6e4,c_fit,co_rgb:21211f,fl_relative,g_north_west,l_text:Yanone%20Kaffeesatz_42_bold_center:${t},w_300,y_300/${nn}${req.photo}`;
    B.text = await fetch(`https://api.imgbb.com/1/upload?key=64baf4d50e6dc55ad766138bc68c1cf6&name=${v.ll}&image=${encodeURIComponent(req.photo)}`).then((r2) => r2.json()).then(async (r2) => {
  // console.info(r2)
	    var i = r2.data.id;
      r2 = [  "ibb.co/" + i, "www.google.com/maps?q=" + v.ll].join("\n")
      var o = { id: i, date: Date.now(), ref: v.ref, ll: v.ll, from: req.from, is: 1 };
      await db.put(o, i);
      return r2;
    });
    B.method = "sendmessage";
  }
  if (req.result_id) {
    await db.put({ is: -1 }, req.result_id)
  }
  if (req.location && !req.id && !req.result_id) {
    //B.photo = `https://www.mapquestapi.com/staticmap/v5/map?key=brX4s7eKqZr24Z1icIAJzRYOBQEWxtVv&banner=${req.location}|lg-21211f-f5e6e4&type=hyb&zoom=17&size=400,400@2x&locations=${req.location}|circle-lg-21211f-f5e6e4`;
  B.photo = `https://www.mapquestapi.com/staticmap/v5/map?key=brX4s7eKqZr24Z1icIAJzRYOBQEWxtVv&type=hyb&zoom=17&size=480,240@2x&locations=${req.location}|circle-lg-21211f-f5e6e4`;

    await fetch(`https://api.cloudinary.com/v1_1/o6/image/upload?upload_preset=o6oooo&file=${encodeURIComponent(B.photo)}`).then((r2) => r2.json()).then(async (r2) => {
      await db.add({ ll: req.location, pic: r2.public_id }, req.from);
    });
	B.reply_markup =   {
  "inline_keyboard": [
    [{
      "text": "L",
        "switch_inline_query": ""
    }, {
      "text": ":RE",
      "switch_inline_query_current_chat": ""
    }]
  ]
}
    B.method = "sendphoto";
  }
  if (req.type == "inline_query") {
    var rrr = await db.list(req.query);
    var l = rrr.length;
    rrr = await rrr.map(({ ref, date, from, ll, id }, o) => ({
      type: "article",
      id,
      title: l - o + " - " + id,
      "description": ref,
      "thumb_url": `https://i.ibb.co/${id}/i.png`,
      "input_message_content": {
        "message_text": [ref, "ibb.co/" + id, "www.google.com/maps?q=" + ll].join("\n")
      }
    }));
    B = {
      method: "answerInlineQuery",
      cache_time: 0,
      is_personal: true,
      inline_query_id: req.id,
      results: rrr
    };
  }
  try {
    if (!B.method && !B.photo && !B.cache_time)
    //console.info(req)
      await bot(req);
  } catch (err) {
    console.warn(err);
  }
  if (req.message_id && !req.via_bot && !req.url)
    await fetch(`https://api.telegram.org/bot${TOKEN}/deleteMessage?chat_id=${req.chat}&message_id=${req.message_id}`);
}

// src/index.js
var import_html = __toESM(require_html());

if (typeof L === "undefined")
  globalThis.L = {};
var src_default = {
  async fetch(request, env, ctx) {
    globalThis.B = {};
    if (request.method === "GET")
      return new Response((0, import_html.html2)(JSON.stringify(request.cf, null, 4)), { headers: {
        "content-type": "text/html;charset=UTF-8"
      } });
    
    try {
     
      await Z(request);
    } catch (err) {
      console.warn(err);
    }
    
    return new Response(JSON.stringify(B, null, 4), {
      headers: {
        "content-type": "application/json"
      }
    });
  }
};
export {
  src_default as default
};
